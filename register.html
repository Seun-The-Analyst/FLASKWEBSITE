<!DOCTYPE html>
<html>
<head>
    <title>User Registration</title>
    <script>
        function toggleAmount(checkbox, textboxId) {
            document.getElementById(textboxId).disabled = !checkbox.checked;
            if (!checkbox.checked) {
                document.getElementById(textboxId).value = '';
            }
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function fillRandomData() {
            document.querySelector('input[name="username"]').value = "user" + getRandomInt(1000, 9999);
            document.querySelector('input[name="password"]').value = "pass" + getRandomInt(1000, 9999);
            document.querySelector('input[name="age"]').value = getRandomInt(18, 60);
            document.querySelector('select[name="gender"]').selectedIndex = getRandomInt(1, 3);
            document.querySelector('input[name="income"]').value = getRandomInt(1000, 10000);

            // Expense categories
            let categories = [
                {cb: "utilities_cb", amt: "utilities_amt"},
                {cb: "entertainment_cb", amt: "entertainment_amt"},
                {cb: "school_fees_cb", amt: "school_fees_amt"},
                {cb: "shopping_cb", amt: "shopping_amt"},
                {cb: "healthcare_cb", amt: "healthcare_amt"}
            ];

            // Uncheck all first
            categories.forEach(cat => {
                document.getElementById(cat.cb).checked = false;
                document.getElementById(cat.amt).disabled = true;
                document.getElementById(cat.amt).value = "";
            });

            // Randomly select just one category
            let idx = getRandomInt(0, categories.length - 1);
            let cat = categories[idx];
            document.getElementById(cat.cb).checked = true;
            document.getElementById(cat.amt).disabled = false;
            document.getElementById(cat.amt).value = getRandomInt(10, 500);
        }
    </script>
</head>
<body>
    <h2>User Registration</h2>
    <form method="POST" action="/">
        <label>Username:</label>
        <input type="text" name="username" required><br><br>
        <label>Password:</label>
        <input type="password" name="password" required><br><br>
        <label>Age:</label>
        <input type="number" name="age" required><br><br>
        <label>Gender:</label>
        <select name="gender" required>
            <option value="">Select</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
        </select><br><br>
        <label>Total Income:</label>
        <input type="number" name="income" required><br><br>
        <label>Expenses:</label><br>
        <input type="checkbox" name="expense_categories" value="utilities" id="utilities_cb" onclick="toggleAmount(this, 'utilities_amt')">
        <label for="utilities_cb">Utilities</label>
        <input type="number" name="utilities_amt" id="utilities_amt" placeholder="Amount" disabled><br>
        <input type="checkbox" name="expense_categories" value="entertainment" id="entertainment_cb" onclick="toggleAmount(this, 'entertainment_amt')">
        <label for="entertainment_cb">Entertainment</label>
        <input type="number" name="entertainment_amt" id="entertainment_amt" placeholder="Amount" disabled><br>
        <input type="checkbox" name="expense_categories" value="school_fees" id="school_fees_cb" onclick="toggleAmount(this, 'school_fees_amt')">
        <label for="school_fees_cb">School Fees</label>
        <input type="number" name="school_fees_amt" id="school_fees_amt" placeholder="Amount" disabled><br>
        <input type="checkbox" name="expense_categories" value="shopping" id="shopping_cb" onclick="toggleAmount(this, 'shopping_amt')">
        <label for="shopping_cb">Shopping</label>
        <input type="number" name="shopping_amt" id="shopping_amt" placeholder="Amount" disabled><br>
        <input type="checkbox" name="expense_categories" value="healthcare" id="healthcare_cb" onclick="toggleAmount(this, 'healthcare_amt')">
        <label for="healthcare_cb">Healthcare</label>
        <input type="number" name="healthcare_amt" id="healthcare_amt" placeholder="Amount" disabled><br><br>
        <input type="submit" value="Register">
    </form>
    <br>
    <button type="button" onclick="fillRandomData()">Fill Random Data</button>
    <a href="{{ url_for('home') }}">Go back to Home</a>
    {% if success %}
        <p style="color: green;">{{ success }}</p>
    {% endif %}
</body>
</html>

